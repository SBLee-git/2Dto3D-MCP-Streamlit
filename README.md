## 2D→3D 맵 변환 프로젝트

**2D 평면도 이미지를 입력받아 3D 벽체 모델(OBJ 파일 묶음)로 자동 변환하는 Streamlit 애플리케이션**

---
### 서비스 개요

2D→3D 맵 변환 프로젝트는 실내 2D 평면도(맵) 이미지를 업로드하면 해당 구조의 3D 벽체 모델을 자동으로 생성해주는 웹 서비스입니다. 
    건물 평면도나 지도 이미지를 일일이 모델링 소프트웨어로 그리지 않고도, 이 도구를 통해 원클릭으로 3D 벽체 OBJ 모델을 얻을 수 있습니다.
    OpenCV 기반의 컴퓨터 비전 기법과 Shapely를 활용한 알고리즘을 통해 이미지에서 벽체 윤곽을 추출하고 높이를 부여하여 3D 형상으로 변환합니다. 
    생성된 3D 모델은 OBJ 형식의 파일들로 제공되며, ZIP으로 묶여 다운로드할 수 있어 Blender 등의 3D 소프트웨어나 로봇 시뮬레이터에서 활용할 수 있습니다.

---
### 내 역할

* **2D-3D 변환 알고리즘 설계 및 구현**: OpenCV를 사용한 이미지 전처리 및 에지 검출, Shapely를 활용한 다각형 병합으로 벽체 추출 알고리즘을 직접 설계하고 구현했습니다. 이를 통해 추출된 다각형 외곽선을 높이 200 단위로 extrusion 하여 OBJ 형식의 3D 메시 데이터를 생성하였습니다.
* **Streamlit 웹 UI 개발**: Python 기반 Streamlit을 이용하여 사용자 인터페이스를 구축했습니다. 파일 업로드 컴포넌트부터 변환 시작 버튼, 변환 진행 로그 표시, 변환 완료 후 ZIP 다운로드 버튼까지 일련의 UI 흐름을 구현하여 사용자가 쉽게 변환 기능을 활용할 수 있도록 했습니다.
* **배포 환경 설정**: Streamlit Cloud에서 앱이 원활히 구동되도록 `requirements.txt`와 `runtime.txt`를 작성하고 종속 라이브러리 및 Python 버전을 세팅했습니다. 프로젝트 코드를 리팩토링하여 클라우드 환경에서도 문제가 없도록 조정하고, 여러 샘플 이미지를 통해 테스트 및 디버깅을 진행했습니다.

---
### 기술 스택

* **언어 및 플랫폼**: Python 3.11, Streamlit 1.45 (웹 애플리케이션 프레임워크)
* **프론트엔드**: Streamlit을 활용한 웹 UI (파일 업로드/다운로드, 버튼, 로그 표시 등 구성)
* **백엔드 알고리즘**: OpenCV (컴퓨터 비전 - 에지 검출 및 이미지 morphological 처리), Shapely (기하 연산을 통한 다각형 병합), NumPy (행렬 및 이미지 데이터 처리)
* **배포**: Streamlit Community Cloud (스트림릿 커뮤니티 클라우드 상에 앱 호스팅)

---
### 서비스 주요 기능 및 UI

* **간편한 변환 프로세스**: 웹 페이지에서 이미지 업로드 → “3D 변환 시작” 버튼 클릭만으로 자동 변환이 이루어집니다. 사용자는 추가 설정 없이도 한 번의 클릭으로 결과를 얻을 수 있습니다.
* **실시간 로그 표시**: 변환 과정에서 주요 단계별로 상태 로그를 UI에 표시하여 투명성을 높였습니다.
    예를 들어 업로드가 완료되면 📥 이미지 업로드 완료, 변환을 시작하면 ⚙️ 변환 준비 중..., 변환이 끝나면 🎉 변환 완료와 같은 로그 아이콘과 메시지가 스트림릿 앱 화면에 실시간으로 출력됩니다.
    이를 통해 사용자는 현재 진행 상태를 바로 확인할 수 있습니다.
* **OBJ 모델 결과물 제공**: 변환 완료 후 “변환 결과 ZIP 다운로드” 버튼이 생성되어, 클릭하면 전체 3D 모델 결과물을 ZIP 파일로 내려받을 수 있습니다.
    ZIP 파일에는 감지된 각 벽체별 OBJ 파일들이 포함되어 있으며, 각 OBJ에는 해당 벽체의 3D 형상이 저장됩니다. 벽체를 개별 OBJ로 분리하여 제공함으로써 후처리 단계에서 특정 벽체만 수정하거나 제거하기가 용이합니다.
* **이미지 캐싱 최적화**: 동일한 이미지를 반복해서 변환하는 경우 알고리즘을 재실행하지 않고 캐시된 결과를 재사용하도록 하였습니다. 업로드한 이미지의 MD5 해시를 키로 변환 결과(ZIP 파일)를 서버 내 `static/` 디렉터리에 저장하고, 이후 동일 이미지 요청 시 즉시 해당 ZIP 경로를 반환함으로써 처리 속도를 향상시켰습니다.
* **지원 입력 및 제한**: 현재 PNG, JPG 등 래스터 이미지 포맷의 평면도 입력을 지원하며, 벽 선이 명확하게 그려진 도면 이미지에 최적화되어 있습니다. (너무 저해상도이거나 벽체 선이 불명확한 이미지는 변환 성능이 떨어질 수 있습니다.)
* UI는 Wide 레이아웃으로 구성되어 큰 화면에서도 편리하게 볼 수 있으며, 업로드된 입력 이미지는 내부적으로 OpenCV로 처리되므로 UI 상에는 바로 표시되지 않지만 변환 로그를 통해 진행 상황을 파악할 수 있습니다. 전반적으로 추가적인 설정 없이 간결한 인터페이스로 누구나 쉽게 사용할 수 있도록 설계되었습니다.

---
### 사용 방법

별도의 로컬 설치 없이 Streamlit Community Cloud 플랫폼에서 바로 이 애플리케이션을 실행할 수 있습니다:

1.  고유 URL ( `https://2dto3d-conversion.streamlit.app/`)로 접속합니다.
2.  웹 앱 UI에 접속하면 이제 로컬 환경과 동일하게 이미지를 업로드하고 3D 변환 기능을 사용할 수 있습니다.

---
### 예시

아래는 간단한 예시 입력과 출력 사례입니다.
예를 들어, 사각형 형태의 방 두 개로 이루어진 2D 평면도 이미지를 입력했다고 가정하면, 변환 완료 후 다음과 같은 ZIP 파일이 생성됩니다.

map_walls_e4a61f...49fd.zip  
├── wall_0.obj  
├── wall_1.obj  
└── ... (벽체 OBJ 파일들)  


위 ZIP 파일을 풀어보면 `wall_0.obj`, `wall_1.obj`, ... 등의 OBJ 파일들이 들어있으며, 각각 감지된 개별 벽체를 3D 모델로 표현합니다. OBJ 파일들은 평면도 이미지 상의 좌표 단위를 그대로 사용하여 모델이 생성되며, 기본 벽 높이는 200 (임의 단위, 예: 200cm)로 설정되어 있습니다. 생성된 OBJ들을 3D 도구로 불러오면 2D 도면과 동일한 배치의 벽체들이 3차원으로 구현된 것을 확인할 수 있습니다.
(예시로 든 ZIP 파일명은 입력 이미지의 해시에 따라 달라지며, `static/` 디렉터리에 저장됩니다.)

---
### 서비스 화면
https://drive.google.com/file/d/1a1L7IYdF2gxOxS8leKou-9FPLJ6isjZi/view?usp=drive_link 

---
### 한계 및 향후 개선

* **지원 기능 범위**: 현재 버전은 벽체 구조만 3D로 변환합니다. 바닥이나 천장, 문이나 창문과 같은 요소는 처리되지 않으며, 입력 이미지에서 이러한 요소를 식별하지 않습니다. 향후 벽 이외의 구조(예: 문이 있는 부분은 벽을 끊어 개구부 처리 등)를 인지하는 기능을 고려해볼 수 있습니다.
* **입력 이미지 품질**: 알고리즘은 입력 이미지에서 명확한 벽 윤곽선을 가정합니다. 만약 이미지 해상도가 너무 낮거나 노이즈가 많은 경우 또는 벽과 바닥이 구분되지 않는 도면의 경우, 에지 검출이 제대로 이루어지지 않아 정확한 3D 변환이 어렵습니다. 전처리 단계에서 이미지 이진화 등의 옵션을 추가로 제공하거나, 사용자가 벽 선 색상을 지정할 수 있도록 개선하면 복잡한 도면에 대한 대응력이 높아질 것입니다.
* **파라미터 커스터마이징**: 현재 벽 높이(기본 200 단위)나 스케일(1 픽셀 ≒ 1 cm)은 코드에 고정되어 있습니다. 이를 UI 상에서 조절 가능하게 하여 사용자가 원하는 높이 또는 축척으로 모델을 생성할 수 있도록 개선할 예정입니다. 예를 들어 층고(height)나 단위 환산(픽셀당 실제 거리)을 입력받으면 보다 정확한 스케일의 3D 모델을 출력할 수 있습니다.

---
2D→3D 맵 변환 프로젝트는 간단한 입력만으로 반복적이고 복잡한 3D 모델링 작업을 자동화하여 효율성을 높이는 도구입니다. 현재는 기본적인 벽체 모델 변환에 초점을 맞추고 있으나, 지속적인 개선을 통해 더욱 다양한 도면 형태를 지원하고, 정교한 3D 환경 생성까지 확장해나갈 예정입니다.
